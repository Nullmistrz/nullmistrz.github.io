---
layout: single
title: "test"
locale: pl-PL
date: 2025-08-09
last_modified_at: 2025-08-09 15:40:00 +0200
categories: posts
translation_id: post-test-2025-08-09
---

## 1. Skrypt do dziennej agregacji transferu LTE na MikroTik

### 1.1 Cel i zastosowanie

Przedstawiam autorski skrypt do routerów MikroTik, który umożliwia precyzyjne monitorowanie dziennego zużycia transferu danych na interfejsie LTE. Skrypt jest przeznaczony do uruchamiania cyklicznego (np. co 15/30/60 minut przez Scheduler) i pozwala na sumowanie ilości pobranych (download) oraz wysłanych (upload) danych w ciągu doby. Dzięki temu można łatwo kontrolować limity transferu narzucone przez operatora lub po prostu monitorować własne zużycie.

### 1.2 Zasada działania

### 1.2.1 Wybór interfejsu LTE
Na początku skryptu definiowana jest nazwa interfejsu LTE, z którego będą pobierane statystyki (domyślnie `lte1`).


### 1.3 Przykładowy kod
```shell
# Skrypt: Agregacja transferu LTE MikroTik
# Autor: Mirosław Biernat
# Data utworzenia: 2025-08-05
# Data ostatniej modyfikacji: 2025-08-05
#
# Opis:
# Skrypt uruchamiany co 15 minut. Przy każdym wywołaniu agreguje przyrost transferu download (RX) i upload (TX) do zmiennych globalnych globalDownload i globalUpload. Pozwala na sumowanie transferu w ciągu dnia.
#
# Historia wersji:
# - 1.0 (2025-08-05): Pierwsza wersja produkcyjna, agregacja RX/TX do zmiennych globalnych, logowanie przyrostów i sumy dziennej.
#
# Opis zmiennych:
# - rxPrevAgg, txPrevAgg – ostatnie wartości liczników RX/TX do porównania przy kolejnym wywołaniu
# - globalDownload, globalUpload – sumaryczny transfer download/upload od początku dnia (w bajtach)
# - deltaRX, deltaTX – przyrost transferu od ostatniego wywołania (w bajtach)
# - iface – nazwa interfejsu LTE
#
# Logi informują o przyroście i sumie dziennej po każdej agregacji.

:local iface "lte1"

# Pobierz aktualne liczniki RX/TX (w bajtach)
:local rxNow [/interface get $iface rx-byte]
:local txNow [/interface get $iface tx-byte]

# Pobierz poprzednie wartości z globalnych zmiennych (jeśli istnieją)
:global rxPrevAgg
:global txPrevAgg
:global globalDownload
:global globalUpload

# Inicjalizacja zmiennych globalnych, jeśli nie istnieją
if ([:typeof $rxPrevAgg] != "num") do={ :set rxPrevAgg $rxNow }
if ([:typeof $txPrevAgg] != "num") do={ :set txPrevAgg $txNow }
if ([:typeof $globalDownload] != "num") do={ :set globalDownload 0 }
if ([:typeof $globalUpload] != "num") do={ :set globalUpload 0 }
```

# Współpraca skryptów

W moim przypadku pierwszy skrypt (agregujący) uruchamiany jest co 59 min 59 sek, a drugi – podsumowujący – raz na dobę o 23:59:00. Dzięki temu uzyskuję pełny, automatyczny monitoring i raportowanie dziennego transferu LTE.